<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SOS2 | CARMUSIC</title>
    <!-- Cascade: דף שליטת מוזיקה לרכב – טוען את עיצוב הממשק הייעודי למסך מגע -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&family=Assistant:wght@400;600&display=swap">
    <link rel="stylesheet" href="./styles/carmusic.css">
</head>
<body class="car-music-dashboard">
    <!-- Cascade: פס עליון המציג את זמן הנסיעה וסטטוס החיבור -->
    <header class="car-top-bar" aria-label="תצוגת על למוסיקת הרכב">
        <div class="top-bar__cluster">
            <button class="top-bar__back" type="button" onclick="window.location.href='index.html'" aria-label="חזרה למסך הראשי">
                <span aria-hidden="true">⬅</span>
                <span>ראשי</span>
            </button>
        </div>
        <div class="top-bar__info">
            <span id="carClock" class="top-bar__time" aria-live="polite">00:00</span>
            <span id="carConnection" class="top-bar__connection">OFFLINE</span>
        </div>
        <div class="top-bar__brand">
            <span class="brand-logo" aria-hidden="true">🚗</span>
            <span class="brand-name">SOS CARMUSIC</span>
        </div>
    </header>

    <!-- Cascade: פס מידע רץ מתחת ללוגו -->
    <div class="car-headline-ticker" aria-live="polite">
        <div class="car-headline-ticker__inner" id="headlineTicker">
            <span class="car-headline-ticker__content" id="headlineTickerContent">SOS CARMUSIC • אין פלייליסט פעיל כרגע • התחילו בהוספת פלייליסט</span>
            <span class="car-headline-ticker__duplicate" aria-hidden="true"></span>
        </div>
    </div>

    <!-- Cascade: מעטפת ראשית עם פריסת דו-אזורית – מסך נגן וארון רשימות השמעה -->
    <main class="car-layout" aria-label="מסך שליטה מרכזי">
        <section class="player-zone" aria-label="מסך הנגן והבקרים">
            <!-- Cascade: תצוגה גרפית של רשימת ההשמעה הפעילה והשיר הנוכחי -->
            <div class="player-display">
                <div class="track-display" id="playerInfo"></div>
                <div class="player-stage" aria-label="נגן YouTube משולב">
                    <div id="carPlayer" class="player-stage__frame"></div>
                </div>
            </div>

            <!-- Cascade: פס בקרה ראשי עם כפתורי מגע גדולים -->
            <div class="control-pad" role="group" aria-label="פקדי השמעה">
                <button id="prevPlaylistBtn" class="control-btn control-btn--aux" type="button" aria-label="רשימת השמעה קודמת">⏮️</button>
                <button id="prevTrackBtn" class="control-btn" type="button" aria-label="שיר קודם">⏪</button>
                <button id="playPauseBtn" class="control-btn control-btn--primary" type="button" aria-label="נגן או עצור">▶</button>
                <button id="nextTrackBtn" class="control-btn" type="button" aria-label="שיר הבא">⏩</button>
                <button id="nextPlaylistBtn" class="control-btn control-btn--aux" type="button" aria-label="רשימת השמעה הבאה">⏭️</button>
                <button id="shuffleBtn" class="control-btn control-btn--toggle" type="button" aria-pressed="false" aria-label="ערבול">🔀</button>
            </div>

            <!-- Cascade: פס סטטוס תחתון המדמה מחשב דרך -->
            <div class="status-strip" aria-live="polite">
                <div class="status-strip__item">
                    <span class="status-strip__label">פלייליסט</span>
                    <span class="status-strip__value" id="statusPlaylistLabel">—</span>
                </div>
                <div class="status-strip__item">
                    <span class="status-strip__label">שיר</span>
                    <span class="status-strip__value" id="statusTrackLabel">—</span>
                </div>
                <div class="status-strip__item">
                    <span class="status-strip__label">מצב</span>
                    <span class="status-strip__value" id="statusModeLabel">עצור</span>
                </div>
            </div>
        </section>

        <!-- Cascade: אזור לצבירת רשימות השמעה עם בחירה במגע -->
        <aside class="library-zone" aria-label="רשימות השמעה שמורות">
            <header class="library-header">
                <div>
                    <h1 class="library-title">CARMUSIC</h1>
                    <p class="library-subtitle">הוסף רשימת השמעה אחת או יותר והפעל בלחיצה.</p>
                </div>
                <button id="openDrawerBtn" class="library-add" type="button" aria-haspopup="dialog">➕ הוסף פלייליסט</button>
            </header>
            <div id="playlistList" class="playlist-grid" role="list"></div>
            <div id="emptyState" class="playlist-empty" hidden>
                <span aria-hidden="true">🎶</span>
                <p>התחילו על ידי הוספת קישור לפלייליסט מיוטיוב.</p>
            </div>
        </aside>
    </main>

    <!-- Cascade: מגירת הוספת פלייליסט בסגנון מערכות רכב -->
    <section id="playlistDrawer" class="drawer" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="drawerTitle">
        <div class="drawer__panel">
            <header class="drawer__header">
                <h2 id="drawerTitle">פלייליסט חדש לרכב</h2>
                <button id="closeDrawerBtn" class="drawer__close" type="button" aria-label="סגירת החלון">✖</button>
            </header>
            <p class="drawer__hint">הדביקו קישור מלא או מזהה של פלייליסט ביוטיוב. נטען את השם והתמונה באופן אוטומטי.</p>
            <label class="drawer__label" for="playlistInput">קישור או מזהה פלייליסט</label>
            <input id="playlistInput" class="drawer__input" type="text" inputmode="url" placeholder="https://youtube.com/playlist?list=...">
            <div id="drawerStatus" class="drawer__status" aria-live="assertive"></div>
            <div class="drawer__actions">
                <button id="savePlaylistBtn" class="drawer__action drawer__action--primary" type="button">שמירה</button>
                <button id="clearPlaylistBtn" class="drawer__action" type="button">ניקוי</button>
            </div>
        </div>
    </section>

    <!-- Cascade: תבנית כרטיס פלייליסט לשימוש דינמי -->
    <template id="playlistCardTemplate">
        <button class="playlist-card" type="button">
            <span class="playlist-card__thumb" aria-hidden="true"></span>
            <span class="playlist-card__name"></span>
            <span class="playlist-card__meta"></span>
        </button>
    </template>

    <!-- Cascade: טעינת נגן YouTube ומודול השליטה -->
    <script src="https://www.youtube.com/iframe_api" async></script>
    <script src="./carmusic.js" defer></script>
</body>
</html>
